# Super Serial

## Description
Try to recover the flag stored on this website http://mercury.picoctf.net:14804/

## Hints
The flag is at ../flag

## Solution
The `robots.txt` shows a `admin.phps`. The suffix is interesting and therefore we 
access the php code of the website when adding this suffix. 
At first we get the `.../index.phps` and get the code shown in `index.php`.
This requires a `cookie.php` which we also get.
Within this file we find a deserialization of a object. Since the challenge is called
`Super Serial` this is Super suspicious. A short search revels that this is a weekness.

And in the first article we get the solution for this challenge:
https://medium.com/swlh/exploiting-php-deserialization-56d71f03282a

Another file is used in `index.php` which is called `authentication.php`. 
We also take this file and within it there is a `access_log` object. 

This access_log has the interesting property of reading a file when the `__toString()` is called.
In `cookie.php` we see, that the deserialized object is printed, when an error occurs in the try.
This will call the `__toString()` method. Fortunately, does using the access_log cause such an error since neither 
`is_guest()` nor `is_admin()` are functions of access_log.

Therefore, we built a serialized access_log object:
`O:10:"access_log":1:{s:8:"log_file";s:7:"../flag";}`

Afterwards, we encode it with base64 and url and get:
`TzoxMDoiYWNjZXNzX2xvZyI6MTp7czo4OiJsb2dfZmlsZSI7czo3OiIuLi9mbGFnIjt9`

Using the python script we get:

`picoCTF{th15_vu1n_1s_5up3r_53r1ous_y4ll_261d1dcc}`


