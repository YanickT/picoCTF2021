# X marks the spot

## Description
Another login you have to bypass. Maybe you can find an injection that works? http://mercury.picoctf.net:33594/
## Hints
- XPATH

## Solution
A quick search revels the website:
https://www.balisage.net/Proceedings/vol7/html/Vlist02/BalisageVol7-Vlist02.html
where the general attack is explained. Its basic structure is:
`' or 0=0 or .='`.
Inserting this we get a `You're on the right path.` message.

Knowing this we can start to determine the password.
At first, we have to determine which user is the admin. 
Due to the names `name`, `pass` in the formula of the html code we expect the node names to match.


Therefore, we at first determine which user is the admin with the `main.py` script and the attack-string:
```attack = f"' or //user[{i}]/name ='admin' or .='"```
The loop breaks at `i=3` and thus the 4th user is the admin.

Afterwards, we try to determine the length of the password. Therefore, we use the script:
```attack = f"' or string-length(//user[3]/pass)={i} or .='"```
We get a length of `i=50` which means 51 chars.

Finally, we use the `get_password(length)` function in the script and determine the password step by step.
To this end we use the string:
`attack = f"' or substring(//user[3]/pass, {j}, 1)='{char}' or .='"`.

The password appears to be the flag.
The flag thus reads:

```picoCTF{h0p3fully_u_t0ok_th3_r1ght_xp4th_8d7f0533}```